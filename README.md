# Multi-source Multi-task Meta-learning with Task-oriented Distribution Alignment for Gastric Cancer Analysis in CT Images
Accurate gastric tumor segmentation and lymph node metastasis (LNM) prediction from computed tomography (CT) scans can provide sufficient and useful image information to guide the diagnosis and treatment of gastric cancer. Domain shift, arising from equipment variations and hospital population diversity in multi-source data, significantly challenges model generalization to unseen domains. In this paper, we study the problem of multi-source domain generalization in gastric tumor segmentation and LNM classification tasks. To address this problem, we propose a novel multi-source multi-task meta-learning (M3L) framework with task-oriented distribution alignment to train a generalizable multi-task model for unseen domains. Specifically, each task prediction branch acts as a meta-learner and is optimized by a meta-learning strategy for task-specific generalization. Additionally, to further mitigate distribution differences between domains, we also design two task-oriented distribution alignment losses to directly regularize the two meta-learners, i.e., a prototype loss for segmentation-related feature alignment and the triplet loss for classification-related feature alignment, respectively. They are both designed as part of the meta-train and meta-test objectives, which facilitate high-order derivatives of parameters during the meta-optimization process to further enhance task-specific domain-invariant features. The extensive experiments are conducted on four CT datasets collected from four medical centers, and comprehensive ablation studies and comparisons with the state-of-the-art methods show the effectiveness of our method for multi-task generalization. Our code will be available at https://github.com/infinite-tao/M3L.
# Requirements
* Python = 3.7
* Pytorch = 1.8.1
* torchvision = 0.9.1
* CUDA = 12.2
* Install other packages in requirements.txt
